### Εκτέλεση δεσμών ενεργειών σε αρχεία

#### Τι είναι οι δέσμες ενεργειών

Η μετονομασία ενός αρχείου με τη χρήση του *bash* είναι αρκετά εύκολη. Θα μπορούσες να χρησιμοποιήσεις την εντολή `mv` για παράδειγμα.

```bash
mv original_file_name.txt new_file_name.txt
```

Τι κάνεις, όμως, αν χρειαστεί να μετονομάσεις χιλιάδες αρχεία;

Μια *δέσμη* ενεργειών είναι όταν χρησιμοποιείς μια εντολή ή ένα σύνολο εντολών σε πολλά αρχεία.

- Δοκίμασε την πρώτη σου δέσμη ενεργειών, χρησιμοποιώντας οποιονδήποτε κατάλογο που περιέχει μερικά αρχεία. Το πρώτο πράγμα που πρέπει να δοκιμάσεις είναι κάτι εύκολο. Για παράδειγμα, θα μπορούσες να αναδημιουργήσεις την εντολή `ls` έτσι ώστε˙
   - για κάθε αρχείο στον κατάλογο,
   - το όνομα του αρχείου να εμφανίζεται στο τερματικό.

- Καταρχάς πρέπει να πεις στο bash ότι θες να εκτελεστεί η ενέργεια σε όλα τα αρχεία του καταλόγου.

    ```bash
    for f in *
    ```

- `f` θα αντιπροσωπεύει κάθε όνομα αρχείου στον κατάλογο το ένα μετά το άλλο.

- Στη συνέχεια θα πρέπει να πεις στο bash τι πρέπει να κάνει με το όνομα του κάθε αρχείου. Σ' αυτή την περίπτωση θες να γίνει `echo` το όνομα του αρχείου στην τυπική έξοδο.

    ```bash
    do
    echo $f
    ```

- Εδώ το σύμβολο `$` χρησιμοποιείται για να δηλώσει ότι μιλάς για τη μεταβλητή `f`. Τέλος πρέπει να πεις στο bash ότι ολοκλήρωσες.

    ```bash
    done
    ```

- Μπορείς να πατάς το πλήκτρο *enter* μετά από κάθε εντολή, αν θέλεις, και το bash δεν θα εκτελεί ολόκληρο το βρόχο μέχρι να πληκτρολογήσεις `done`, συνεπώς η εντολή θα φαίνεται έτσι στο τερματικό:

    ```bash
    for f in *.txt
    > do
    > echo $f
    > done
    ```

- Εναλλακτικά, αντί να πατάς *Enter* μετά από κάθε γραμμή, θα μπορούσες να χρησιμοποιήσεις το `;` για να διαχωρίσεις τις εντολές.

    ```bash
    for f in *.txt; do echo $f; done
    ```

#### Χειρισμός (συμβολο)σειρών.

Αυτή η εντολή που δημιούργησες ήταν ίσως λίγο άσκοπη, όμως μπορείς να κάνεις πολλά περισσότερα με τις δέσμες ενεργειών. Για παράδειγμα, θα μπορούσες να αλλάξεις το όνομα κάθε αρχείου, έτσι ώστε αντί να ονομάζεται `O.txt`, να ονομάζεται `0.md`.

- Δοκίμασε αυτή την εντολή:

    ```bash
    for f in *.txt; do mv "$f" "${f%.txt}.md"; done
    ```

- Αν κάνεις `ls` στα περιεχόμενα του καταλόγου, θα δεις πως όλα τα αρχεία έχουν μετονομαστεί. Με ποιον τρόπο έγινε αυτό;

- Το πρώτο μέρος `for f in *.txt` λέει στο bash να εκτελέσει την ενέργεια σε κάθε αρχείο (`$f`) που έχει επέκταση `.txt.`

- Στη συνέχεια η εντολή `do mv $f` λέει στο bash να *μετακινήσει* καθένα απ' αυτά τα αρχεία. Κατόπιν θα πρέπει να δώσεις στο bash το νέο όνομα του μετακινούμενου αρχείου. Για να γίνει αυτό θα πρέπει να αφαιρέσεις την επέκταση `.txt` και να την αντικαταστήσεις με `.md`. Ευτυχώς το bash έχει έναν ενσωματωμένο τελεστή που αφαιρεί το τελευταίο μέρος μιας (συμβολο)σειράς. Μπορείς να χρησιμοποιήσεις τον τελεστή `%`. Δοκίμασε αυτό το παράδειγμα για να δεις πώς λειτουργεί

    ```bash
    words="Hello World"
    echo ${words%World}
    ```

- Τώρα θα μπορούσες να προσθέσεις κάτι άλλο στο τέλος της (συμβολο)σειράς.

    ```bash
    echo ${words%World)Moon
    ```

- Έτσι, η εντολή `${f%.txt}.md` αντικαθιστά όλα τα σύμβολα `.txt` με τα σύμβολα `.md`. Παρεμπιπτόντως, η χρήση του τελεστή `#` αντί του `%` θα αφαιρούσε το αρχικό κομμάτι της (συμβολο)σειράς  αντί για το τελικό.

